const a0_0x442301=a0_0x1d11;function a0_0x1d11(_0xe02321,_0x497293){const _0x2f862d=a0_0x2f86();return a0_0x1d11=function(_0x1d1130,_0x5dadd4){_0x1d1130=_0x1d1130-0x16a;let _0x53a3be=_0x2f862d[_0x1d1130];return _0x53a3be;},a0_0x1d11(_0xe02321,_0x497293);}function a0_0x2f86(){const _0x2f52a0=['hide','data','remove','\x20(ends\x20on\x20','marker','33248QPEaPa','appendChild','getAttribute','198760AVvrjA','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_3.jpg','promotionContainerPromotions','show','from','22JIAxmS','length','push','img-fluid','modal-open','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_4.jpg','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_2.jpg','309WrYhcK','clearLayers','7hAmbMT','promotion_id','then','classList','promotion-item','display','promotion-text','click','some','https://raw.githubusercontent.com/pttpos/map_ptt/main/data/markers.json','add','No\x20description','getInstance','126DyNWTp','div','147272JyjULj','toLowerCase','addLayer','https://raw.githubusercontent.com/pttpos/map_ptt/main/data/promotions.json','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_2.jpg','STATION','querySelector','promotionModal','querySelectorAll','flyToBounds','promotion-image','Modal','opening','end_time','featureGroup','addEventListener','515ARDaEr','block','hidden.bs.modal','.modal-backdrop','animate','selected','station_id','promotions','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_3.jpg','toggle','promotionContainerAll','style','Error\x20loading\x20promotion\x20data:','pulse-animation','data-promotion-id','.promotion-image','1038583uDKJvr','img','PROMOTIONS',')\x20-\x20','getElementById','forEach','startsWith','436512KxiMMS','mb-2','getTime','mb-3','Invalid\x20date:\x20','body','innerHTML','catch','none','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_1.jpg','includes','#promotionModal\x20.btn-close','12438IrYlGP','function','506060pgieml','createElement','clearAllButton','getBounds'];a0_0x2f86=function(){return _0x2f52a0;};return a0_0x2f86();}(function(_0x2780b1,_0x14755b){const _0x322af8=a0_0x1d11,_0x5bb914=_0x2780b1();while(!![]){try{const _0x4b9380=-parseInt(_0x322af8(0x191))/0x1*(-parseInt(_0x322af8(0x1a0))/0x2)+parseInt(_0x322af8(0x18f))/0x3*(parseInt(_0x322af8(0x180))/0x4)+-parseInt(_0x322af8(0x1b0))/0x5*(parseInt(_0x322af8(0x175))/0x6)+parseInt(_0x322af8(0x1c0))/0x7+parseInt(_0x322af8(0x183))/0x8+parseInt(_0x322af8(0x19e))/0x9*(-parseInt(_0x322af8(0x177))/0xa)+parseInt(_0x322af8(0x188))/0xb*(-parseInt(_0x322af8(0x1c7))/0xc);if(_0x4b9380===_0x14755b)break;else _0x5bb914['push'](_0x5bb914['shift']());}catch(_0x5edb48){_0x5bb914['push'](_0x5bb914['shift']());}}}(a0_0x2f86,0x8649f));function showPromotionModal(_0x170ee9){const _0x2eb3f8=a0_0x1d11;var _0x192c02=new bootstrap[(_0x2eb3f8(0x1ab))](document['getElementById'](_0x2eb3f8(0x1a7)),{'keyboard':![]}),_0x469967=document['getElementById']('promotionContainerAll'),_0x10a263=document[_0x2eb3f8(0x1c4)](_0x2eb3f8(0x185)),_0x138e38=document[_0x2eb3f8(0x1c4)]('promotionContainerOpenings');_0x469967['innerHTML']='',_0x10a263[_0x2eb3f8(0x16f)]='',_0x138e38[_0x2eb3f8(0x16f)]='';if(_0x170ee9&&_0x170ee9[_0x2eb3f8(0x189)]>0x0)_0x170ee9[_0x2eb3f8(0x1c5)](_0x3a21d8=>{const _0x56b7c7=_0x2eb3f8,_0x2a1df3=getPromotionImageUrl(_0x3a21d8['promotion_id']);createAndAppendPromotionElements(_0x3a21d8,_0x2a1df3,_0x469967);if(_0x3a21d8['promotion_id'][_0x56b7c7(0x1a1)]()[_0x56b7c7(0x1c6)]('promotion')&&!_0x3a21d8[_0x56b7c7(0x192)][_0x56b7c7(0x1a1)]()[_0x56b7c7(0x173)](_0x56b7c7(0x1ac)))createAndAppendPromotionElements(_0x3a21d8,_0x2a1df3,_0x10a263);else _0x3a21d8[_0x56b7c7(0x192)]['toLowerCase']()[_0x56b7c7(0x173)](_0x56b7c7(0x1ac))&&createAndAppendPromotionElements(_0x3a21d8,_0x2a1df3,_0x138e38);}),_0x192c02[_0x2eb3f8(0x186)]();else{}addPromotionImageEventListeners();}function addPromotionImageEventListeners(){const _0x104f76=document['querySelectorAll']('.promotion-image');_0x104f76['forEach'](_0x7efac1=>{const _0x39890e=a0_0x1d11;_0x7efac1[_0x39890e(0x194)][_0x39890e(0x19b)](_0x39890e(0x1b4)),_0x7efac1[_0x39890e(0x1af)]('click',function(){const _0x1d1450=_0x39890e,_0x402871=this[_0x1d1450(0x182)]('data-promotion-id');this[_0x1d1450(0x194)][_0x1d1450(0x1b9)](_0x1d1450(0x1b5)),filterMarkersByPromotion(_0x402871),updateClearFilterButton();});});}function createAndAppendPromotionElements(_0x5b8a9e,_0x20b699,_0x508bb2){const _0x3f0d0d=a0_0x1d11,_0x400870=document[_0x3f0d0d(0x178)](_0x3f0d0d(0x19f));_0x400870['classList'][_0x3f0d0d(0x19b)](_0x3f0d0d(0x195),_0x3f0d0d(0x16c));const _0xf029cd=document[_0x3f0d0d(0x178)](_0x3f0d0d(0x1c1));_0xf029cd['src']=_0x20b699,_0xf029cd[_0x3f0d0d(0x194)][_0x3f0d0d(0x19b)](_0x3f0d0d(0x18b),_0x3f0d0d(0x16a),_0x3f0d0d(0x1aa)),_0xf029cd['setAttribute'](_0x3f0d0d(0x1be),_0x5b8a9e[_0x3f0d0d(0x192)]);const _0x19ff27=document[_0x3f0d0d(0x178)]('p');_0x19ff27[_0x3f0d0d(0x194)][_0x3f0d0d(0x19b)](_0x3f0d0d(0x197)),_0x19ff27['innerText']=_0x5b8a9e[_0x3f0d0d(0x192)]+_0x3f0d0d(0x17e)+formatPromotionEndTime(_0x5b8a9e[_0x3f0d0d(0x1ad)])+_0x3f0d0d(0x1c3)+(_0x5b8a9e['description']||_0x3f0d0d(0x19c)),_0x400870[_0x3f0d0d(0x181)](_0xf029cd),_0x400870[_0x3f0d0d(0x181)](_0x19ff27),_0x508bb2[_0x3f0d0d(0x181)](_0x400870);}function formatPromotionEndTime(_0x5522ac){const _0x2a3268=a0_0x1d11,_0x4888c9=new Date(_0x5522ac);if(isNaN(_0x4888c9[_0x2a3268(0x16b)]()))return error(_0x2a3268(0x16d)+_0x5522ac),'Invalid\x20Date';return _0x4888c9['toLocaleDateString']();}function getPromotionImageUrl(_0x88fb82){const _0x3ca52c=a0_0x1d11,_0xacb09e={'promotion\x201':'https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_1.jpg','promotion\x202':_0x3ca52c(0x1a4),'promotion\x203':_0x3ca52c(0x184),'promotion\x204':'https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_4.jpg','promotion\x20opening\x201':_0x3ca52c(0x172),'promotion\x20opening\x202':_0x3ca52c(0x18e),'promotion\x20opening\x203':_0x3ca52c(0x1b8),'promotion\x20opening\x204':_0x3ca52c(0x18d)};return _0xacb09e[_0x88fb82]||'https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/default.png';}function filterMarkersByPromotion(_0x31c8fa){const _0x3ee54f=a0_0x1d11;markers[_0x3ee54f(0x190)]();let _0x4ec89f=[];allMarkers[_0x3ee54f(0x1c5)](_0x1c8afe=>{const _0x5c747b=_0x3ee54f;_0x1c8afe[_0x5c747b(0x17c)][_0x5c747b(0x1b7)]&&_0x1c8afe[_0x5c747b(0x17c)][_0x5c747b(0x1b7)][_0x5c747b(0x199)](_0x3544b7=>_0x3544b7[_0x5c747b(0x192)]===_0x31c8fa)&&(markers[_0x5c747b(0x1a2)](_0x1c8afe[_0x5c747b(0x17f)]),_0x4ec89f[_0x5c747b(0x18a)](_0x1c8afe[_0x5c747b(0x17f)]));}),map['addLayer'](markers);if(_0x4ec89f['length']>0x0){const _0x4eefec=new L[(_0x3ee54f(0x1ae))](_0x4ec89f),_0x7bba03=_0x4eefec[_0x3ee54f(0x17a)]();map[_0x3ee54f(0x1a9)](_0x7bba03,{'animate':!![],'duration':0x1});}var _0x5d719b=document['getElementById'](_0x3ee54f(0x1a7)),_0x2ff829=bootstrap[_0x3ee54f(0x1ab)][_0x3ee54f(0x19d)](_0x5d719b);_0x2ff829[_0x3ee54f(0x17b)](),updateClearFilterButton();}function populatePromotions(_0x3bd8bf){const _0x294835=a0_0x1d11,_0x2889b4=document[_0x294835(0x1c4)]('promotionBtn'),_0x165784=document[_0x294835(0x1c4)]('promotionNotificationDot');_0x3bd8bf['some'](_0x1d96ab=>_0x1d96ab[_0x294835(0x1b7)]&&_0x1d96ab[_0x294835(0x1b7)][_0x294835(0x189)]>0x0)?(_0x165784[_0x294835(0x1bb)][_0x294835(0x196)]='block',_0x165784[_0x294835(0x194)][_0x294835(0x19b)](_0x294835(0x1bd))):(_0x165784[_0x294835(0x1bb)][_0x294835(0x196)]='none',_0x165784[_0x294835(0x194)][_0x294835(0x17d)]('pulse-animation')),_0x2889b4[_0x294835(0x1af)](_0x294835(0x198),function(){const _0x278b48=_0x294835,_0x823317=_0x3bd8bf['flatMap'](_0x47d96e=>_0x47d96e[_0x278b48(0x1b7)]||[]),_0x48d450=Array[_0x278b48(0x187)](new Map(_0x823317['map'](_0x47caef=>[_0x47caef['promotion_id'],_0x47caef]))['values']());_0x48d450[_0x278b48(0x189)]>0x0&&showPromotionModal(_0x48d450);});}function arePromotionFiltersApplied(){const _0x47c877=a0_0x1d11,_0x5f0df6=document[_0x47c877(0x1a8)]('.promotion-image.selected');return _0x5f0df6['length']>0x0;}function updateClearFilterButton(){const _0x2a8b86=a0_0x1d11,_0x5efbaa=document[_0x2a8b86(0x1c4)](_0x2a8b86(0x179)),_0x32b6de=typeof areFiltersApplied===_0x2a8b86(0x176)?areFiltersApplied():![],_0x2d727b=arePromotionFiltersApplied();_0x32b6de||_0x2d727b?_0x5efbaa[_0x2a8b86(0x1bb)][_0x2a8b86(0x196)]=_0x2a8b86(0x1b1):_0x5efbaa[_0x2a8b86(0x1bb)][_0x2a8b86(0x196)]=_0x2a8b86(0x171);}function clearAllSelections(){const _0x312117=a0_0x1d11;typeof clearGeneralFilters==='function'&&clearGeneralFilters();const _0x4c61a2=document[_0x312117(0x1a8)](_0x312117(0x1bf));_0x4c61a2[_0x312117(0x1c5)](_0x405244=>{const _0x842ad7=_0x312117;_0x405244[_0x842ad7(0x194)][_0x842ad7(0x17d)](_0x842ad7(0x1b5));}),markers[_0x312117(0x190)](),allMarkers[_0x312117(0x1c5)](_0x3565ae=>{const _0x4198c2=_0x312117;markers[_0x4198c2(0x1a2)](_0x3565ae[_0x4198c2(0x17f)]);}),map[_0x312117(0x1a2)](markers);const _0x2638b3=allMarkers['map'](_0x1db188=>_0x1db188[_0x312117(0x17f)]);if(_0x2638b3[_0x312117(0x189)]>0x0){const _0xf9ee0a=new L[(_0x312117(0x1ae))](_0x2638b3),_0x82bfae=_0xf9ee0a[_0x312117(0x17a)]();map[_0x312117(0x1a9)](_0x82bfae,{'animate':!![],'duration':0x1});}updateClearFilterButton();}document[a0_0x442301(0x1c4)](a0_0x442301(0x179))[a0_0x442301(0x1af)]('click',clearAllSelections),fetch(a0_0x442301(0x19a))[a0_0x442301(0x193)](_0x137ef4=>_0x137ef4['json']())['then'](_0x3afebb=>{const _0xcfcbee=a0_0x442301,_0x3da1e7=_0x3afebb[_0xcfcbee(0x1a5)];fetch(_0xcfcbee(0x1a3))[_0xcfcbee(0x193)](_0x3c0747=>_0x3c0747['json']())[_0xcfcbee(0x193)](_0x32254c=>{const _0x3a586b=_0xcfcbee,_0x2b9cc6=_0x32254c[_0x3a586b(0x1c2)];_0x3da1e7['forEach'](_0x51657c=>{const _0x37f10d=_0x3a586b,_0x9f2dd0=_0x2b9cc6['find'](_0x8d66ff=>_0x8d66ff[_0x37f10d(0x1b6)]===parseInt(_0x51657c['id']));_0x9f2dd0&&(_0x51657c[_0x37f10d(0x1b7)]=_0x9f2dd0[_0x37f10d(0x1b7)]);}),populatePromotions(_0x3da1e7);})['catch'](_0x4cf303=>_0x4cf303(_0xcfcbee(0x1bc),_0x4cf303));})[a0_0x442301(0x170)](_0x2650b7=>_0x2650b7('Error\x20loading\x20station\x20data:',_0x2650b7)),document[a0_0x442301(0x1c4)](a0_0x442301(0x1a7))[a0_0x442301(0x1af)](a0_0x442301(0x1b2),function(){const _0xbe3776=a0_0x442301;document[_0xbe3776(0x1c4)](_0xbe3776(0x1ba))[_0xbe3776(0x16f)]='',document[_0xbe3776(0x1c4)](_0xbe3776(0x185))['innerHTML']='',document['getElementById']('promotionContainerOpenings')[_0xbe3776(0x16f)]='',document[_0xbe3776(0x16e)][_0xbe3776(0x194)][_0xbe3776(0x17d)](_0xbe3776(0x18c)),document['querySelectorAll'](_0xbe3776(0x1b3))[_0xbe3776(0x1c5)](_0x4388d5=>_0x4388d5[_0xbe3776(0x17d)]());}),document[a0_0x442301(0x1a6)](a0_0x442301(0x174))['addEventListener'](a0_0x442301(0x198),function(){const _0x10f135=a0_0x442301;var _0x2caa79=bootstrap['Modal']['getInstance'](document[_0x10f135(0x1c4)](_0x10f135(0x1a7)));_0x2caa79['hide'](),document[_0x10f135(0x16e)][_0x10f135(0x194)][_0x10f135(0x17d)](_0x10f135(0x18c)),document[_0x10f135(0x1a8)](_0x10f135(0x1b3))[_0x10f135(0x1c5)](_0x1dc479=>_0x1dc479['remove']());});