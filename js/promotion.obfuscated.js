const a0_0x7f0ffc=a0_0x3bd8;(function(_0x12aa52,_0x81e38e){const _0x4e16b9=a0_0x3bd8,_0x41ad10=_0x12aa52();while(!![]){try{const _0x34a3fb=parseInt(_0x4e16b9(0xe4))/0x1+-parseInt(_0x4e16b9(0x130))/0x2+-parseInt(_0x4e16b9(0x10e))/0x3+-parseInt(_0x4e16b9(0x106))/0x4+-parseInt(_0x4e16b9(0xe8))/0x5+parseInt(_0x4e16b9(0xd7))/0x6*(parseInt(_0x4e16b9(0x104))/0x7)+parseInt(_0x4e16b9(0xe9))/0x8*(parseInt(_0x4e16b9(0x105))/0x9);if(_0x34a3fb===_0x81e38e)break;else _0x41ad10['push'](_0x41ad10['shift']());}catch(_0x290728){_0x41ad10['push'](_0x41ad10['shift']());}}}(a0_0x1f1f,0x65c60));function showPromotionModal(_0x5ba9ce){const _0xb82b55=a0_0x3bd8;var _0x4be8e8=new bootstrap[(_0xb82b55(0x10b))](document[_0xb82b55(0x11b)](_0xb82b55(0x11e)),{'keyboard':![]}),_0x46017f=document[_0xb82b55(0x11b)](_0xb82b55(0xe7)),_0x167a04=document[_0xb82b55(0x11b)](_0xb82b55(0xed)),_0x351a9d=document['getElementById']('promotionContainerOpenings');_0x46017f[_0xb82b55(0x11a)]='',_0x167a04[_0xb82b55(0x11a)]='',_0x351a9d['innerHTML']='';if(_0x5ba9ce&&_0x5ba9ce[_0xb82b55(0x111)]>0x0)_0x5ba9ce[_0xb82b55(0xe0)](_0x5c5c16=>{const _0x5836d7=_0xb82b55,_0x425673=getPromotionImageUrl(_0x5c5c16[_0x5836d7(0xfe)]);createAndAppendPromotionElements(_0x5c5c16,_0x425673,_0x46017f);if(_0x5c5c16[_0x5836d7(0xfe)][_0x5836d7(0xdd)]()['startsWith']('promotion')&&!_0x5c5c16['promotion_id'][_0x5836d7(0xdd)]()['includes']('opening'))createAndAppendPromotionElements(_0x5c5c16,_0x425673,_0x167a04);else _0x5c5c16[_0x5836d7(0xfe)][_0x5836d7(0xdd)]()[_0x5836d7(0x123)](_0x5836d7(0x128))&&createAndAppendPromotionElements(_0x5c5c16,_0x425673,_0x351a9d);}),_0x4be8e8[_0xb82b55(0x109)]();else{}addPromotionImageEventListeners();}function addPromotionImageEventListeners(){const _0x1d381=a0_0x3bd8,_0x5748f7=document['querySelectorAll'](_0x1d381(0xf8));_0x5748f7['forEach'](_0x40cc02=>{const _0x22abe2=_0x1d381;_0x40cc02[_0x22abe2(0xd9)][_0x22abe2(0x11c)](_0x22abe2(0xf5)),_0x40cc02[_0x22abe2(0xf1)]('click',function(){const _0x2cc64d=_0x22abe2,_0x206caa=this[_0x2cc64d(0x132)](_0x2cc64d(0x117));this[_0x2cc64d(0xd9)][_0x2cc64d(0xd5)]('selected'),filterMarkersByPromotion(_0x206caa),updateClearFilterButton();});});}function a0_0x1f1f(){const _0x539ad2=['remove','flyToBounds','promotionContainerOpenings','1002320CmOFZk','promotion-text','getAttribute','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_4.jpg','toggle','promotions','18oTCUZw','getInstance','classList','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/default.png','selected','querySelectorAll','toLowerCase','map','#promotionModal\x20.btn-close','forEach','values','appendChild','from','429209WcqxbD','catch','data','promotionContainerAll','1024605rUKojf','2088SPjEtK','pulse-animation','div','station_id','promotionContainerPromotions','clearAllButton','img','promotion-image','addEventListener','marker','getBounds','innerText','animate','style','Error\x20loading\x20station\x20data:','.promotion-image','some','promotion-item','setAttribute','mb-3','src','promotion_id','.modal-backdrop','querySelector','flatMap','https://raw.githubusercontent.com/pttpos/map_ptt/main/data/promotions.json','json','1343321pKLPZf','38619eimLvZ','881408mWJjwu','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_3.jpg','No\x20description','show','hide','Modal','PROMOTIONS','block','2344716RJcEZu','display','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_2.jpg','length','clearLayers','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_3.jpg','then','modal-open','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_1.jpg','data-promotion-id','none','getTime','innerHTML','getElementById','add','\x20(ends\x20on\x20','promotionModal','mb-2','find','function','addLayer','includes','featureGroup','Error\x20loading\x20promotion\x20data:','click','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_4.jpg','opening','img-fluid','body','Invalid\x20Date',')\x20-\x20'];a0_0x1f1f=function(){return _0x539ad2;};return a0_0x1f1f();}function createAndAppendPromotionElements(_0x185be8,_0x461647,_0x297009){const _0x3c7952=a0_0x3bd8,_0x4e3f36=document['createElement'](_0x3c7952(0xeb));_0x4e3f36[_0x3c7952(0xd9)][_0x3c7952(0x11c)](_0x3c7952(0xfa),_0x3c7952(0xfc));const _0x51b741=document['createElement'](_0x3c7952(0xef));_0x51b741[_0x3c7952(0xfd)]=_0x461647,_0x51b741[_0x3c7952(0xd9)]['add'](_0x3c7952(0x129),_0x3c7952(0x11f),_0x3c7952(0xf0)),_0x51b741[_0x3c7952(0xfb)](_0x3c7952(0x117),_0x185be8[_0x3c7952(0xfe)]);const _0x41505e=document['createElement']('p');_0x41505e[_0x3c7952(0xd9)]['add'](_0x3c7952(0x131)),_0x41505e[_0x3c7952(0xf4)]=_0x185be8[_0x3c7952(0xfe)]+_0x3c7952(0x11d)+formatPromotionEndTime(_0x185be8['end_time'])+_0x3c7952(0x12c)+(_0x185be8['description']||_0x3c7952(0x108)),_0x4e3f36[_0x3c7952(0xe2)](_0x51b741),_0x4e3f36['appendChild'](_0x41505e),_0x297009[_0x3c7952(0xe2)](_0x4e3f36);}function formatPromotionEndTime(_0x16e2b5){const _0x47b4f3=a0_0x3bd8,_0x301c6e=new Date(_0x16e2b5);if(isNaN(_0x301c6e[_0x47b4f3(0x119)]()))return error('Invalid\x20date:\x20'+_0x16e2b5),_0x47b4f3(0x12b);return _0x301c6e['toLocaleDateString']();}function getPromotionImageUrl(_0x1caa58){const _0x5dafbe=a0_0x3bd8,_0x4b4fe2={'promotion\x201':_0x5dafbe(0x116),'promotion\x202':_0x5dafbe(0x110),'promotion\x203':_0x5dafbe(0x113),'promotion\x204':_0x5dafbe(0xd4),'promotion\x20opening\x201':'https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_1.jpg','promotion\x20opening\x202':'https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_2.jpg','promotion\x20opening\x203':_0x5dafbe(0x107),'promotion\x20opening\x204':_0x5dafbe(0x127)};return _0x4b4fe2[_0x1caa58]||_0x5dafbe(0xda);}function filterMarkersByPromotion(_0x59897d){const _0x49aa3c=a0_0x3bd8;markers[_0x49aa3c(0x112)]();let _0x38c0e6=[];allMarkers['forEach'](_0x20abcc=>{const _0x825b8d=_0x49aa3c;_0x20abcc['data'][_0x825b8d(0xd6)]&&_0x20abcc[_0x825b8d(0xe6)][_0x825b8d(0xd6)]['some'](_0x578fc9=>_0x578fc9['promotion_id']===_0x59897d)&&(markers[_0x825b8d(0x122)](_0x20abcc['marker']),_0x38c0e6['push'](_0x20abcc[_0x825b8d(0xf2)]));}),map['addLayer'](markers);if(_0x38c0e6[_0x49aa3c(0x111)]>0x0){const _0x10131a=new L[(_0x49aa3c(0x124))](_0x38c0e6),_0x5b2584=_0x10131a[_0x49aa3c(0xf3)]();map[_0x49aa3c(0x12e)](_0x5b2584,{'animate':!![],'duration':0x1});}var _0x1ae2d1=document[_0x49aa3c(0x11b)](_0x49aa3c(0x11e)),_0x2fb2b9=bootstrap[_0x49aa3c(0x10b)][_0x49aa3c(0xd8)](_0x1ae2d1);_0x2fb2b9[_0x49aa3c(0x10a)](),updateClearFilterButton();}function a0_0x3bd8(_0x414254,_0x51f711){const _0x1f1f31=a0_0x1f1f();return a0_0x3bd8=function(_0x3bd87d,_0x19b393){_0x3bd87d=_0x3bd87d-0xd4;let _0x105c22=_0x1f1f31[_0x3bd87d];return _0x105c22;},a0_0x3bd8(_0x414254,_0x51f711);}function populatePromotions(_0x579632){const _0x55f2ff=a0_0x3bd8,_0x6bdeb8=document[_0x55f2ff(0x11b)]('promotionBtn'),_0xbb7de5=document['getElementById']('promotionNotificationDot');_0x579632[_0x55f2ff(0xf9)](_0x3d0729=>_0x3d0729[_0x55f2ff(0xd6)]&&_0x3d0729[_0x55f2ff(0xd6)][_0x55f2ff(0x111)]>0x0)?(_0xbb7de5[_0x55f2ff(0xf6)][_0x55f2ff(0x10f)]=_0x55f2ff(0x10d),_0xbb7de5[_0x55f2ff(0xd9)][_0x55f2ff(0x11c)](_0x55f2ff(0xea))):(_0xbb7de5[_0x55f2ff(0xf6)]['display']=_0x55f2ff(0x118),_0xbb7de5[_0x55f2ff(0xd9)]['remove'](_0x55f2ff(0xea))),_0x6bdeb8['addEventListener']('click',function(){const _0x13a81e=_0x55f2ff,_0x48ad4e=_0x579632[_0x13a81e(0x101)](_0x17dd30=>_0x17dd30['promotions']||[]),_0x52b12d=Array[_0x13a81e(0xe3)](new Map(_0x48ad4e[_0x13a81e(0xde)](_0x4e12e4=>[_0x4e12e4['promotion_id'],_0x4e12e4]))[_0x13a81e(0xe1)]());_0x52b12d[_0x13a81e(0x111)]>0x0&&showPromotionModal(_0x52b12d);});}function arePromotionFiltersApplied(){const _0x3893d1=document['querySelectorAll']('.promotion-image.selected');return _0x3893d1['length']>0x0;}function updateClearFilterButton(){const _0x1e9138=a0_0x3bd8,_0x5a2258=document[_0x1e9138(0x11b)](_0x1e9138(0xee)),_0x21f321=typeof areFiltersApplied===_0x1e9138(0x121)?areFiltersApplied():![],_0x2d7a88=arePromotionFiltersApplied();_0x21f321||_0x2d7a88?_0x5a2258[_0x1e9138(0xf6)]['display']=_0x1e9138(0x10d):_0x5a2258[_0x1e9138(0xf6)][_0x1e9138(0x10f)]='none';}function clearAllSelections(){const _0x308098=a0_0x3bd8;typeof clearGeneralFilters===_0x308098(0x121)&&clearGeneralFilters();const _0xca5d97=document[_0x308098(0xdc)](_0x308098(0xf8));_0xca5d97[_0x308098(0xe0)](_0x495b9f=>{const _0x583a38=_0x308098;_0x495b9f['classList'][_0x583a38(0x12d)](_0x583a38(0xdb));}),markers['clearLayers'](),allMarkers[_0x308098(0xe0)](_0x103510=>{markers['addLayer'](_0x103510['marker']);}),map[_0x308098(0x122)](markers);const _0x35a6b1=allMarkers['map'](_0x41b402=>_0x41b402['marker']);if(_0x35a6b1['length']>0x0){const _0x43519d=new L[(_0x308098(0x124))](_0x35a6b1),_0x4afeda=_0x43519d[_0x308098(0xf3)]();map[_0x308098(0x12e)](_0x4afeda,{'animate':!![],'duration':0x1});}updateClearFilterButton();}document[a0_0x7f0ffc(0x11b)](a0_0x7f0ffc(0xee))[a0_0x7f0ffc(0xf1)](a0_0x7f0ffc(0x126),clearAllSelections),fetch('https://raw.githubusercontent.com/pttpos/map_ptt/main/data/markers.json')['then'](_0x3a60b0=>_0x3a60b0[a0_0x7f0ffc(0x103)]())[a0_0x7f0ffc(0x114)](_0x3a074b=>{const _0x3a8eea=a0_0x7f0ffc,_0x1b8341=_0x3a074b['STATION'];fetch(_0x3a8eea(0x102))[_0x3a8eea(0x114)](_0xda0a45=>_0xda0a45[_0x3a8eea(0x103)]())[_0x3a8eea(0x114)](_0x1ee8b3=>{const _0x524901=_0x3a8eea,_0x104ded=_0x1ee8b3[_0x524901(0x10c)];_0x1b8341[_0x524901(0xe0)](_0x66fe49=>{const _0x116af6=_0x524901,_0x1b4677=_0x104ded[_0x116af6(0x120)](_0xaba892=>_0xaba892[_0x116af6(0xec)]===parseInt(_0x66fe49['id']));_0x1b4677&&(_0x66fe49[_0x116af6(0xd6)]=_0x1b4677['promotions']);}),populatePromotions(_0x1b8341);})[_0x3a8eea(0xe5)](_0x213292=>_0x213292(_0x3a8eea(0x125),_0x213292));})['catch'](_0x17aa05=>_0x17aa05(a0_0x7f0ffc(0xf7),_0x17aa05)),document[a0_0x7f0ffc(0x11b)](a0_0x7f0ffc(0x11e))['addEventListener']('hidden.bs.modal',function(){const _0x490ba7=a0_0x7f0ffc;document[_0x490ba7(0x11b)](_0x490ba7(0xe7))['innerHTML']='',document[_0x490ba7(0x11b)](_0x490ba7(0xed))[_0x490ba7(0x11a)]='',document[_0x490ba7(0x11b)](_0x490ba7(0x12f))[_0x490ba7(0x11a)]='',document[_0x490ba7(0x12a)][_0x490ba7(0xd9)]['remove'](_0x490ba7(0x115)),document[_0x490ba7(0xdc)]('.modal-backdrop')[_0x490ba7(0xe0)](_0x13b78e=>_0x13b78e[_0x490ba7(0x12d)]());}),document[a0_0x7f0ffc(0x100)](a0_0x7f0ffc(0xdf))[a0_0x7f0ffc(0xf1)](a0_0x7f0ffc(0x126),function(){const _0x5503c9=a0_0x7f0ffc;var _0x2b3cf5=bootstrap['Modal'][_0x5503c9(0xd8)](document[_0x5503c9(0x11b)]('promotionModal'));_0x2b3cf5['hide'](),document[_0x5503c9(0x12a)][_0x5503c9(0xd9)][_0x5503c9(0x12d)]('modal-open'),document[_0x5503c9(0xdc)](_0x5503c9(0xff))[_0x5503c9(0xe0)](_0x1c013b=>_0x1c013b[_0x5503c9(0x12d)]());});