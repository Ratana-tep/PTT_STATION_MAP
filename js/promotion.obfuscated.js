function a0_0x3863(_0x411131,_0x3b8e14){const _0x3238c6=a0_0x3238();return a0_0x3863=function(_0x38638d,_0x333b67){_0x38638d=_0x38638d-0x101;let _0xd7b8b6=_0x3238c6[_0x38638d];return _0xd7b8b6;},a0_0x3863(_0x411131,_0x3b8e14);}const a0_0x4b7f13=a0_0x3863;(function(_0x2c8b19,_0x4461f8){const _0xda41d9=a0_0x3863,_0x23db1a=_0x2c8b19();while(!![]){try{const _0x1be0eb=-parseInt(_0xda41d9(0x114))/0x1*(-parseInt(_0xda41d9(0x159))/0x2)+parseInt(_0xda41d9(0x119))/0x3+-parseInt(_0xda41d9(0x104))/0x4*(-parseInt(_0xda41d9(0x127))/0x5)+-parseInt(_0xda41d9(0x13f))/0x6*(-parseInt(_0xda41d9(0x136))/0x7)+-parseInt(_0xda41d9(0x118))/0x8+parseInt(_0xda41d9(0x132))/0x9+-parseInt(_0xda41d9(0x13d))/0xa;if(_0x1be0eb===_0x4461f8)break;else _0x23db1a['push'](_0x23db1a['shift']());}catch(_0x2eaee9){_0x23db1a['push'](_0x23db1a['shift']());}}}(a0_0x3238,0xe2594));function showPromotionModal(_0x29f5c4){const _0x34f74b=a0_0x3863;var _0x7bc618=new bootstrap[(_0x34f74b(0x105))](document['getElementById'](_0x34f74b(0x149)),{'keyboard':![]}),_0x2442ad=document['getElementById']('promotionContainerAll'),_0x456171=document[_0x34f74b(0x130)](_0x34f74b(0x13e)),_0x2b1839=document[_0x34f74b(0x130)]('promotionContainerOpenings');_0x2442ad[_0x34f74b(0x147)]='',_0x456171['innerHTML']='',_0x2b1839[_0x34f74b(0x147)]='',_0x29f5c4&&_0x29f5c4['length']>0x0?(_0x29f5c4[_0x34f74b(0x10a)](_0x1334c5=>{const _0xb0cb67=_0x34f74b,_0xd3d9ac=getPromotionImageUrl(_0x1334c5[_0xb0cb67(0x154)]);createAndAppendPromotionElements(_0x1334c5,_0xd3d9ac,_0x2442ad);if(_0x1334c5['promotion_id'][_0xb0cb67(0x102)]()['startsWith'](_0xb0cb67(0x111))&&!_0x1334c5['promotion_id']['toLowerCase']()[_0xb0cb67(0x157)](_0xb0cb67(0x116)))createAndAppendPromotionElements(_0x1334c5,_0xd3d9ac,_0x456171);else _0x1334c5[_0xb0cb67(0x154)][_0xb0cb67(0x102)]()[_0xb0cb67(0x157)]('opening')&&createAndAppendPromotionElements(_0x1334c5,_0xd3d9ac,_0x2b1839);}),_0x7bc618[_0x34f74b(0x10d)]()):alert(_0x34f74b(0x148)),addPromotionImageEventListeners();}function addPromotionImageEventListeners(){const _0x572036=a0_0x3863,_0xd3dada=document['querySelectorAll'](_0x572036(0x139));_0xd3dada['forEach'](_0x1e9ee2=>{const _0x2c987d=_0x572036;_0x1e9ee2[_0x2c987d(0x13c)]['add'](_0x2c987d(0x14b)),_0x1e9ee2[_0x2c987d(0x142)](_0x2c987d(0x11a),function(){const _0x5e3b53=_0x2c987d,_0x18b40a=this['getAttribute'](_0x5e3b53(0x14d));this[_0x5e3b53(0x13c)][_0x5e3b53(0x123)](_0x5e3b53(0x12f)),filterMarkersByPromotion(_0x18b40a),updateClearFilterButton();});});}function createAndAppendPromotionElements(_0x300045,_0x49a9c3,_0x2cde04){const _0x5ebd5d=a0_0x3863,_0x16d491=document['createElement'](_0x5ebd5d(0x158));_0x16d491[_0x5ebd5d(0x13c)][_0x5ebd5d(0x137)](_0x5ebd5d(0x144),_0x5ebd5d(0x10b));const _0x49354b=document[_0x5ebd5d(0x15d)]('img');_0x49354b[_0x5ebd5d(0x133)]=_0x49a9c3,_0x49354b['classList'][_0x5ebd5d(0x137)](_0x5ebd5d(0x14f),_0x5ebd5d(0x15f),_0x5ebd5d(0x11d)),_0x49354b['setAttribute'](_0x5ebd5d(0x14d),_0x300045[_0x5ebd5d(0x154)]);const _0xfd77df=document[_0x5ebd5d(0x15d)]('p');_0xfd77df[_0x5ebd5d(0x13c)][_0x5ebd5d(0x137)](_0x5ebd5d(0x14a)),_0xfd77df[_0x5ebd5d(0x146)]=_0x300045[_0x5ebd5d(0x154)]+_0x5ebd5d(0x12c)+formatPromotionEndTime(_0x300045[_0x5ebd5d(0x14c)])+_0x5ebd5d(0x109)+(_0x300045[_0x5ebd5d(0x140)]||_0x5ebd5d(0x14e)),_0x16d491['appendChild'](_0x49354b),_0x16d491[_0x5ebd5d(0x12a)](_0xfd77df),_0x2cde04['appendChild'](_0x16d491);}function formatPromotionEndTime(_0x361674){const _0x4cf82a=a0_0x3863,_0x317cf1=new Date(_0x361674);if(isNaN(_0x317cf1[_0x4cf82a(0x152)]()))return error('Invalid\x20date:\x20'+_0x361674),_0x4cf82a(0x117);return _0x317cf1[_0x4cf82a(0x11c)]();}function getPromotionImageUrl(_0x2b6c9a){const _0xce8174=a0_0x3863,_0x7b0a2f={'promotion\x201':'https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_1.jpg','promotion\x202':'https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_2.jpg','promotion\x203':_0xce8174(0x15b),'promotion\x204':_0xce8174(0x12d),'promotion\x20opening\x201':_0xce8174(0x141),'promotion\x20opening\x202':'https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_2.jpg','promotion\x20opening\x203':'https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_3.jpg','promotion\x20opening\x204':_0xce8174(0x107)};return _0x7b0a2f[_0x2b6c9a]||_0xce8174(0x13b);}function filterMarkersByPromotion(_0x5af957){const _0x2865d2=a0_0x3863;markers[_0x2865d2(0x131)]();let _0x5f311c=[];allMarkers[_0x2865d2(0x10a)](_0x47f196=>{const _0x26be16=_0x2865d2;_0x47f196[_0x26be16(0x151)]['promotions']&&_0x47f196[_0x26be16(0x151)][_0x26be16(0x11e)][_0x26be16(0x15a)](_0x55ba3a=>_0x55ba3a[_0x26be16(0x154)]===_0x5af957)&&(markers['addLayer'](_0x47f196[_0x26be16(0x12e)]),_0x5f311c[_0x26be16(0x129)](_0x47f196[_0x26be16(0x12e)]));}),map[_0x2865d2(0x15c)](markers);if(_0x5f311c[_0x2865d2(0x120)]>0x0){const _0x4db484=new L[(_0x2865d2(0x112))](_0x5f311c),_0x379565=_0x4db484[_0x2865d2(0x134)]();map[_0x2865d2(0x124)](_0x379565,{'animate':!![],'duration':0x1});}var _0x3b6223=document[_0x2865d2(0x130)](_0x2865d2(0x149)),_0x41224f=bootstrap['Modal']['getInstance'](_0x3b6223);_0x41224f[_0x2865d2(0x13a)](),updateClearFilterButton();}function a0_0x3238(){const _0x3492af=['7899039hMrUxa','src','getBounds','json','13895hecAKZ','add','catch','.promotion-image','hide','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/default.png','classList','28396920bxhszM','promotionContainerPromotions','5274CPQhbM','description','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_1.jpg','addEventListener','display','promotion-item','.modal-backdrop','innerText','innerHTML','No\x20promotion\x20available.','promotionModal','promotion-text','animate','end_time','data-promotion-id','No\x20description','img-fluid','STATION','data','getTime','promotionNotificationDot','promotion_id','map','block','includes','div','2iplxkH','some','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_3.jpg','addLayer','createElement','body','mb-2','https://raw.githubusercontent.com/pttpos/map_ptt/main/data/promotions.json','remove','toLowerCase','promotionBtn','4492sTyQDP','Modal','pulse-animation','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_opening_4.jpg','querySelectorAll',')\x20-\x20','forEach','mb-3','modal-open','show','clearAllButton','then','.promotion-image.selected','promotion','featureGroup','style','1672943ufKixh','getInstance','opening','Invalid\x20Date','10969824kkafKL','344733ysLSQV','click','hidden.bs.modal','toLocaleDateString','promotion-image','promotions','Error\x20loading\x20promotion\x20data:','length','promotionContainerAll','#promotionModal\x20.btn-close','toggle','flyToBounds','PROMOTIONS','none','3240rdQVfy','from','push','appendChild','promotionContainerOpenings','\x20(ends\x20on\x20','https://raw.githubusercontent.com/pttpos/map_ptt/main/pictures/promotion/promotion_4.jpg','marker','selected','getElementById','clearLayers'];a0_0x3238=function(){return _0x3492af;};return a0_0x3238();}function populatePromotions(_0x21a8aa){const _0x2a3609=a0_0x3863,_0x295975=document[_0x2a3609(0x130)](_0x2a3609(0x103)),_0x4db67e=document[_0x2a3609(0x130)](_0x2a3609(0x153));_0x21a8aa[_0x2a3609(0x15a)](_0x3dc940=>_0x3dc940[_0x2a3609(0x11e)]&&_0x3dc940[_0x2a3609(0x11e)][_0x2a3609(0x120)]>0x0)?(_0x4db67e[_0x2a3609(0x113)][_0x2a3609(0x143)]=_0x2a3609(0x156),_0x4db67e[_0x2a3609(0x13c)][_0x2a3609(0x137)](_0x2a3609(0x106))):(_0x4db67e[_0x2a3609(0x113)][_0x2a3609(0x143)]=_0x2a3609(0x126),_0x4db67e[_0x2a3609(0x13c)][_0x2a3609(0x101)](_0x2a3609(0x106))),_0x295975['addEventListener']('click',function(){const _0x2cfa00=_0x2a3609,_0x15a0b1=_0x21a8aa['flatMap'](_0x159e28=>_0x159e28[_0x2cfa00(0x11e)]||[]),_0x30ebf6=Array[_0x2cfa00(0x128)](new Map(_0x15a0b1[_0x2cfa00(0x155)](_0x3b7072=>[_0x3b7072[_0x2cfa00(0x154)],_0x3b7072]))['values']());_0x30ebf6[_0x2cfa00(0x120)]>0x0?showPromotionModal(_0x30ebf6):alert(_0x2cfa00(0x148));});}function arePromotionFiltersApplied(){const _0xb93464=a0_0x3863,_0x3abb6e=document[_0xb93464(0x108)](_0xb93464(0x110));return _0x3abb6e[_0xb93464(0x120)]>0x0;}function updateClearFilterButton(){const _0x3f3c9b=a0_0x3863,_0xc58f7f=document[_0x3f3c9b(0x130)](_0x3f3c9b(0x10e)),_0x2bb2a1=typeof areFiltersApplied==='function'?areFiltersApplied():![],_0x2d4780=arePromotionFiltersApplied();_0x2bb2a1||_0x2d4780?_0xc58f7f[_0x3f3c9b(0x113)]['display']=_0x3f3c9b(0x156):_0xc58f7f[_0x3f3c9b(0x113)][_0x3f3c9b(0x143)]='none';}function clearAllSelections(){const _0x52bfa6=a0_0x3863;typeof clearGeneralFilters==='function'&&clearGeneralFilters();const _0x2709a9=document[_0x52bfa6(0x108)]('.promotion-image');_0x2709a9['forEach'](_0x325e0e=>{const _0x498311=_0x52bfa6;_0x325e0e[_0x498311(0x13c)][_0x498311(0x101)](_0x498311(0x12f));}),markers[_0x52bfa6(0x131)](),allMarkers['forEach'](_0x284ddb=>{const _0x91a49b=_0x52bfa6;markers['addLayer'](_0x284ddb[_0x91a49b(0x12e)]);}),map[_0x52bfa6(0x15c)](markers);const _0x14b2ce=allMarkers[_0x52bfa6(0x155)](_0x1e752f=>_0x1e752f['marker']);if(_0x14b2ce[_0x52bfa6(0x120)]>0x0){const _0x3d71fe=new L[(_0x52bfa6(0x112))](_0x14b2ce),_0x14950b=_0x3d71fe['getBounds']();map[_0x52bfa6(0x124)](_0x14950b,{'animate':!![],'duration':0x1});}updateClearFilterButton();}document['getElementById'](a0_0x4b7f13(0x10e))[a0_0x4b7f13(0x142)]('click',clearAllSelections),fetch('https://raw.githubusercontent.com/pttpos/map_ptt/main/data/markers.json')['then'](_0x25203e=>_0x25203e[a0_0x4b7f13(0x135)]())['then'](_0x56dfdd=>{const _0x360f4f=a0_0x4b7f13,_0x58b2d6=_0x56dfdd[_0x360f4f(0x150)];fetch(_0x360f4f(0x160))[_0x360f4f(0x10f)](_0x4889ef=>_0x4889ef[_0x360f4f(0x135)]())[_0x360f4f(0x10f)](_0xfc2b81=>{const _0xfe903b=_0x360f4f,_0x17983e=_0xfc2b81[_0xfe903b(0x125)];_0x58b2d6['forEach'](_0x1ee8e0=>{const _0xaf3745=_0xfe903b,_0xd21d0e=_0x17983e['find'](_0xda82=>_0xda82['station_id']===parseInt(_0x1ee8e0['id']));_0xd21d0e&&(_0x1ee8e0['promotions']=_0xd21d0e[_0xaf3745(0x11e)]);}),populatePromotions(_0x58b2d6);})[_0x360f4f(0x138)](_0x37b982=>_0x37b982(_0x360f4f(0x11f),_0x37b982));})[a0_0x4b7f13(0x138)](_0x17913d=>_0x17913d('Error\x20loading\x20station\x20data:',_0x17913d)),document[a0_0x4b7f13(0x130)](a0_0x4b7f13(0x149))[a0_0x4b7f13(0x142)](a0_0x4b7f13(0x11b),function(){const _0x1ee424=a0_0x4b7f13;document[_0x1ee424(0x130)](_0x1ee424(0x121))[_0x1ee424(0x147)]='',document[_0x1ee424(0x130)](_0x1ee424(0x13e))[_0x1ee424(0x147)]='',document['getElementById'](_0x1ee424(0x12b))[_0x1ee424(0x147)]='',document[_0x1ee424(0x15e)]['classList'][_0x1ee424(0x101)]('modal-open'),document[_0x1ee424(0x108)](_0x1ee424(0x145))['forEach'](_0x421d0d=>_0x421d0d[_0x1ee424(0x101)]());}),document['querySelector'](a0_0x4b7f13(0x122))['addEventListener'](a0_0x4b7f13(0x11a),function(){const _0x137516=a0_0x4b7f13;var _0x553329=bootstrap[_0x137516(0x105)][_0x137516(0x115)](document[_0x137516(0x130)](_0x137516(0x149)));_0x553329[_0x137516(0x13a)](),document[_0x137516(0x15e)][_0x137516(0x13c)][_0x137516(0x101)](_0x137516(0x10c)),document[_0x137516(0x108)](_0x137516(0x145))['forEach'](_0x27f183=>_0x27f183[_0x137516(0x101)]());});